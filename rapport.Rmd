---
title: "Rapport"
author: "Polluscope"
date: "19/03/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(plotly)
library(plyr)
library(sqldf)
library(flexdashboard)
set.seed(955)
load("~/environnement.RData")
```
## Anomalies : 
  * Les participant qui ont répondu plusieurs fois au questionnaire :    
9999915 2 fois, 99999 3 fois, 9999975 2fois, 9999988 2fois  
  * Les participant qui n'ont pas répondu au questionnaire et qu'on a leurs mesures :  
  9999993, 9999921, 9999924*, 9999961 
  * Les participant qui ont répondu au questionnaire et qui nous manquent leurs mesures :    
9999972, 9999943, 9999938, 9999934, 9999950, 999992, 9999930, 9999974, 9999920, 9999936, 9999955, 9999960, 9999953, 9999968  
9999951, 9999977, 9999984, 9999910, 9999949, 9999962, 9999981, 9999986, 9999997, 9999990, 9999989, 9999935, 9999979, 9999937  
9999947, 9999976, 9999952  
* Donnée fausse : Température ligne 843 pour les mesures du participant 9999967 : 1644 pour la température et l'humidity.   
* A partir de question q_39 du questionnaire 999952 on trouve un décalage de deux colonnes.
* les coresspondances mal compris entre l'activité et l'évènement : 

"9999915","2019-10-21 11:04:00+00","4","5","5","28.6","28.6","10","3564","Vélo","Allumage De Cheminée"  

"9999915","2019-10-21 11:05:00+00","4","5","5","28.4","28.4","14","3167","Vélo","Allumage De Cheminée"  

"9999915","2019-10-21 11:06:00+00","3","5","5","27.9","27.9","30","-395","Vélo","Allumage De Cheminée"  

"9999915","2019-10-21 11:07:00+00","4","5","5","26.2","26.2","10","-198","Vélo","Allumage De Cheminée"  

"9999915","2019-10-21 11:14:00+00","5","6","6","20.8","20.8","65","2675","Vélo","Allumage De Cheminée"  

"9999915","2019-10-21 11:15:00+00","3","3","3","19.5","19.5","36","936","Vélo","Allumage De Cheminée"  

"9999915","2019-10-21 11:17:00+00","9","10","10","20.1","20.1","49","1548","Vélo","Allumage De Cheminée"  

"9999916","2019-10-21 17:52:00+00","2","2","2","25.3","25.3","6","1311","Voiture","Sport"  

"9999916","2019-10-24 07:06:00+00","3","3","3","22.6","22.6","39","1466","Rue","Fermeture De Fenêtre"  

"9999941","2019-12-16 08:19:00+00","22","25","25","25.9","25.9","10","3621","Voiture","Marcher"  

"9999944","2019-10-21 19:23:00+00","57","81","81","27.1","27.1","1",NULL,"Bus","Cuisiner"  
## Moyenne, médiane et variance:  
* PM2.5
```{r  warning=FALSE,echo=FALSE}
summary(df$PM2.5)
```
la variance est de `r var(df$PM2.5) `  
* PM10
```{r  warning=FALSE,echo=FALSE}
summary(df$PM10)
```

la variance est de `r var(df$PM10) `  
* PM1.0
```{r  warning=FALSE,echo=FALSE}
summary(df$PM1.0)
```
la variance est de `r var(df$PM1.0) `  

## Plots :  

```{r  warning=FALSE,echo=FALSE}
c <-  ggplot(data=resultatFinal, aes(x=MOY_PM2.5,y=Categorie)) + 
     geom_histogram(alpha=0.8,stat='identity',breaks=seq(20, 50, by=2), col="red", aes(fill=..x..)) +
    scale_fill_gradient("PM2.5", low="green", high="red")+labs(x="Moyenne de PM2.5",y="Catégorie")+ggtitle("Moyenne de PM2.5 par rapport la catégorie")

ggplotly(c)
```
On voit que le degré de PM2.5 est plus élevé chez les non sportifs et les personnes ayant l'age entre 35 et 50 et plus bas chez les personnes avec des revenus moins de 2000

```{r  warning=FALSE,echo=FALSE}
p <-  ggplot(data=resultatFinal, aes(x=MOY_PM10,y=Categorie)) + 
     geom_histogram(alpha=0.8,stat='identity',breaks=seq(20, 50, by=2), col="red", 
                    aes(fill=..x..)) +
    scale_fill_gradient("PM10", low="green", high="red")+
  labs(x="PM10",y="Catégorie")+ggtitle("Moyenne de PM10 par rapport la catégorie")

ggplotly(p)
```

le PM10 très élevé pour les non sportifs et les personnes dont l'age est entre 35 et 50 et légèrement chez les exposés à la fumee.

```{r warning=FALSE,echo=FALSE}

p <-  ggplot(data=resultatFinal, aes(x=MOY_PM1.0,y=Categorie)) +
     geom_histogram(alpha=0.8,stat='identity',breaks=seq(20, 50, by=2),   col="red", aes(fill=..x..)) +
    scale_fill_gradient("PM1.0", low="green", high="red")+ labs(x="Moyenne de PM1.0",y="Catégorie")+
ggtitle("Moyenne de PM1.0 par rapport la catégorie")
ggplotly(p)
```
le PM10 très élevé pour les non sportifs et les personnes dont l'age est entre 35 et 50 et légèrement chez les exposés à la fumee.  
les moins exposés à PM1.0 sont les jeunes moins de 20 ans et les participants ayant le revenu moins de 2000.

```{r warning=FALSE,echo=FALSE}

p <-  ggplot(data=resultatFinal, aes(x=MOY_NO2,y=Categorie)) + 
     geom_histogram(alpha=0.8,stat='identity',breaks=seq(20, 50, by=2),   col="red",  aes(fill=..x..)) +
    scale_fill_gradient("NO2", low="green", high="red")+labs(x="Moyenne de NO2",y="Catégorie")+
    ggtitle("Moyenne de NO2 par rapport la catégorie")
ggplotly(p)
```
NO2 est très élevé pour les non sportifs et les personnes dont l'age est entre 35 et 50 et légèrement chez les exposés à la fumee.  
les moins exposés à l'NO2 sont les locataires.
```{r warning=FALSE,echo=FALSE}

p <-  ggplot(data=resultatFinal, aes(x=MOY_BC,y=Categorie)) + 
     geom_histogram(alpha=0.8,stat='identity',breaks=seq(20, 50, by=2),   col="red", aes(fill=..x..)) +
    scale_fill_gradient("BC", low="green", high="red")+
  labs(x="Moyenne de BC",y="Catégorie")+
    ggtitle("Moyenne de BC par rapport la catégorie")
ggplotly(p)
```
+ on apercoit que le niveau de bc est moins important pour ceux qui prennent le transport en commun par rapport à ceux qui ne le prennent du tout ou utilisent les moyens doux(vélo trottinette)
## Étude sur le Black Carbone(BC):  
```{r warning=FALSE,echo=FALSE}

p <-  ggplot(data=activite, aes(x=activity,y=MOY_BC)) + 
     geom_histogram(alpha=0.8,stat='identity',breaks=seq(20, 50, by=2),bandwidth=8) +ggtitle("Moyenne de BC en fontion de l'acitivité")
ggplotly(p)
```

 BC est un polluant de l'air émis lors de réaction de combustion. Ce qui explique que les activités en voiture et au restaurants ont une grande moyenne de BC. Mais bizarrement le pic est au niveau de l'activité du vélo.  
Donc on se focaliser l'activité Vélo pour voir la provenance de ce pic.
```{r warning=FALSE,echo=FALSE}

p <- ggplot(data=velo,aes(x=participant_virtual_id,y=MOY_BC))+geom_histogram(alpha=0.8,stat='identity',breaks=seq(20, 50, by=2))+xlab("participant")+ylab("MOY_BC")+ggtitle("Moyenne BC  en fontion du participant ")
ggplotly(p)

```

On voit d'après ce graphe que seulement 2 participants font du vélo le 9999915 et le 9999916 mais   on va comparé ses 2 participants pour savoir pourquoi le pic de BC viens de lui

```{r warning=FALSE,echo=FALSE}

p <-  ggplot(data=p9999916, aes(x=activity,y=MOY_BC)) + 
     geom_histogram(alpha=0.8,stat='identity',breaks=seq(20, 50, by=2)) +ggtitle("Moyenne de BC en fontion de l'acitivité")
ggplotly(p)
```

```{r warning=FALSE,echo=FALSE}

p <-  ggplot(data=p9999915, aes(x=activity,y=MOY_BC)) + 
     geom_histogram(alpha=0.8,stat='identity',breaks=seq(20, 50, by=2),bandwidth=8) +ggtitle("Moyenne de BC en fontion de l'acitivité")
ggplotly(p)
```

On remarque que pour ses 2 participants que le BC est plus élevé quand ils sont à l'extérieur de leur domicile ou de leur bureau

